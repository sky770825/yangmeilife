<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>稅費試算 - 濬瑒房產生活平台</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root{
  --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  --success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  --warning: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
  --glass-bg: rgba(255, 255, 255, 0.25);
  --glass-border: rgba(255, 255, 255, 0.18);
  --glass-dark: rgba(30, 30, 30, 0.25);
  --glass-dark-border: rgba(255, 255, 255, 0.1);
  --shadow-soft: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
  --shadow-hover: 0 15px 35px rgba(31, 38, 135, 0.2);
  --border-radius: 1rem;
  --border-radius-lg: 1.5rem;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body{
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  transition: var(--transition);
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  line-height: 1.6;
  color: #333;
}

body.dark {
  background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
  color: #f8f9fa;
}

.container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0.75rem;
}

.glass-card{
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-radius: var(--border-radius);
  border: 1px solid var(--glass-border);
  box-shadow: var(--shadow-soft);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.glass-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
}

.glass-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-hover);
}

body.dark .glass-card {
  background: var(--glass-dark);
  border: 1px solid var(--glass-dark-border);
}

.tax-item{
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  border-radius: 0.5rem;
  padding: 0.75rem;
  margin-bottom: 0.5rem;
  transition: var(--transition);
  border: 1px solid rgba(255, 255, 255, 0.3);
  position: relative;
}

.tax-item:hover {
  transform: translateX(5px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

body.dark .tax-item {
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.result-card{
  background: var(--primary);
  color: white;
  border-radius: var(--border-radius-lg);
  padding: 2rem;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.result-card::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
  animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
  0%, 100% { transform: translateX(-100%) translateY(-100%) rotate(30deg); }
  50% { transform: translateX(100%) translateY(100%) rotate(30deg); }
}

.input-group {
  position: relative;
  margin-bottom: 1rem;
}

.input-group label {
  display: block;
  font-weight: 600;
  margin-bottom: 0.375rem;
  color: #374151;
  font-size: 0.85rem;
}

body.dark .input-group label {
  color: #f3f4f6;
}

.input-group input,
.input-group select {
  width: 100%;
  padding: 0.625rem 0.75rem;
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 0.5rem;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  transition: var(--transition);
  font-size: 0.9rem;
  color: #374151;
}

.input-group input:focus,
.input-group select:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  transform: translateY(-2px);
}

body.dark .input-group input,
body.dark .input-group select {
  background: rgba(30, 30, 30, 0.8);
  border: 2px solid rgba(255, 255, 255, 0.1);
  color: #f3f4f6;
}

#themeToggle{
  position: fixed;
  top: 1rem;
  right: 1rem;
  background: var(--primary);
  color: #fff;
  border: none;
  padding: 0.75rem;
  border-radius: 50%;
  z-index: 50;
  transition: var(--transition);
  cursor: pointer;
  font-size: 1.2rem;
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

#themeToggle:hover {
  transform: scale(1.1) rotate(180deg);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
}

.back-btn {
  position: fixed;
  top: 1rem;
  left: 1rem;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  border: none;
  padding: 0.75rem;
  border-radius: 50%;
  z-index: 50;
  transition: var(--transition);
  cursor: pointer;
  font-size: 1.2rem;
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.back-btn:hover {
  transform: scale(1.1);
  background: rgba(255, 255, 255, 1);
}

body.dark .back-btn {
  background: rgba(30, 30, 30, 0.8);
  color: #f3f4f6;
}

.section-title {
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 0.375rem;
}

.tax-amount {
  font-weight: 700;
  font-size: 0.9rem;
}

.tax-description {
  font-size: 0.75rem;
  opacity: 0.8;
  margin-top: 0.125rem;
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1.2fr;
  gap: 1.25rem;
  align-items: start;
}

.grid-3 {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1rem;
}

.input-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 0.75rem;
}

.tax-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
}

@media (max-width: 768px) {
  .grid-2,
  .grid-3,
  .tax-grid {
    grid-template-columns: 1fr;
  }
  
  .input-grid {
    grid-template-columns: 1fr;
  }
  
  .container {
    padding: 0.5rem;
  }
  
  .result-card {
    padding: 1.5rem;
  }
  
  .grid-2 {
    gap: 1rem;
  }
}

.fade-in {
  animation: fadeIn 0.6s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.pulse {
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.8;
  }
}
</style>
</head>
<body>
<!-- 主題切換 -->
<button id="themeToggle" aria-label="切換主題模式">🌞</button>

<!-- 返回按鈕 -->
<button onclick="history.back()" class="back-btn" aria-label="返回上一頁">
  ←
</button>

<!-- 標題區 -->
<header class="text-center py-6 fade-in">
  <div class="container">
    <h1 class="text-3xl font-bold text-white mb-2">📄 稅費試算工具</h1>
    <p class="text-base opacity-90 text-white">2025年房地合一稅2.0最新稅制</p>
  </div>
</header>

<main class="container py-4">
  <div class="grid-2">
    <!-- 左側：輸入區域 -->
    <div class="space-y-4">
      <!-- 基本資訊 -->
      <section class="glass-card p-5 fade-in">
        <h2 class="section-title">
          <span class="text-2xl">📏</span>
          <span>房屋資訊</span>
        </h2>
        <div class="input-grid">
          <div class="input-group">
            <label>房屋總價 (萬元)</label>
            <input type="number" id="housePrice" placeholder="例如：1500" value="1500">
          </div>
          <div class="input-group">
            <label>取得成本 (萬元)</label>
            <input type="number" id="costPrice" placeholder="例如：1200" value="1200">
          </div>
          <div class="input-group">
            <label>房屋類型</label>
            <select id="houseType">
              <option value="new">新建房屋</option>
              <option value="used" selected>中古屋</option>
            </select>
          </div>
          <div class="input-group">
            <label>持有年限</label>
            <select id="holdYears">
              <option value="1">1年內</option>
              <option value="2">1-2年</option>
              <option value="5">2-5年</option>
              <option value="10" selected>5-10年</option>
              <option value="20">10年以上</option>
            </select>
          </div>
          <div class="input-group">
            <label>房屋用途</label>
            <select id="houseUsage">
              <option value="self" selected>自用住宅</option>
              <option value="investment">投資用途</option>
              <option value="business">營業用途</option>
            </select>
          </div>
          <div class="input-group">
            <label>是否為首次購屋</label>
            <select id="firstTimeBuyer">
              <option value="no" selected>否</option>
              <option value="yes">是</option>
            </select>
          </div>
          <div class="input-group">
            <label>土地面積 (坪)</label>
            <input type="number" id="landArea" placeholder="例如：25" value="25">
          </div>
          <div class="input-group">
            <label>建物面積 (坪)</label>
            <input type="number" id="buildingArea" placeholder="例如：35" value="35">
          </div>
        </div>
      </section>

    </div>

    <!-- 右側：結果區域 -->
    <div class="space-y-4">
      <!-- 稅費總計 -->
      <section class="result-card pulse">
        <h3 class="text-xl font-bold mb-3">💰 稅費總計</h3>
        <div class="grid grid-cols-2 gap-3 text-center mb-3">
          <div class="bg-white/20 rounded-lg p-3">
            <div class="text-xl font-bold" id="buyerTotal">NT$ 72,500</div>
            <div class="text-xs opacity-80">買方負擔</div>
          </div>
          <div class="bg-white/20 rounded-lg p-3">
            <div class="text-xl font-bold" id="sellerTotal">NT$ 60,000</div>
            <div class="text-xs opacity-80">賣方負擔</div>
          </div>
        </div>
        <div class="pt-3 border-t border-white/20">
          <div class="text-2xl font-bold" id="totalTax">NT$ 132,500</div>
          <div class="text-xs opacity-80">總稅費</div>
        </div>
      </section>

      <!-- 稅費明細 -->
      <div class="tax-grid">
        <!-- 買方稅費 -->
        <section class="glass-card p-5 fade-in">
          <h2 class="section-title">
            <span class="text-2xl">💰</span>
            <span>買方稅費</span>
          </h2>
          <div class="space-y-2">
            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏠 契稅</h3>
                  <p class="tax-description">房屋移轉登記稅</p>
                </div>
                <span class="tax-amount text-blue-600" id="deedTax">NT$ 45,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">📋 印花稅</h3>
                  <p class="tax-description">契約書印花稅</p>
                </div>
                <span class="tax-amount text-blue-600" id="stampTax">NT$ 1,500</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">📝 登記規費</h3>
                  <p class="tax-description">地政事務所規費</p>
                </div>
                <span class="tax-amount text-blue-600" id="registrationFee">NT$ 3,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏦 銀行費用</h3>
                  <p class="tax-description">貸款設定費、手續費</p>
                </div>
                <span class="tax-amount text-blue-600" id="bankFee">NT$ 8,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏢 代書費</h3>
                  <p class="tax-description">代書服務費用</p>
                </div>
                <span class="tax-amount text-blue-600" id="notaryFee">NT$ 15,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏠 仲介費 (買方)</h3>
                  <p class="tax-description">買方負擔仲介服務費 2%</p>
                </div>
                <span class="tax-amount text-blue-600" id="buyerAgentFee">NT$ 30,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🔍 履約保證費</h3>
                  <p class="tax-description">履約保證服務費</p>
                </div>
                <span class="tax-amount text-blue-600" id="guaranteeFee">NT$ 5,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">📋 火險地震險</h3>
                  <p class="tax-description">第一年保險費用</p>
                </div>
                <span class="tax-amount text-blue-600" id="insuranceFee">NT$ 3,000</span>
              </div>
            </div>
          </div>
        </section>

        <!-- 賣方稅費 -->
        <section class="glass-card p-5 fade-in">
          <h2 class="section-title">
            <span class="text-2xl">💸</span>
            <span>賣方稅費</span>
          </h2>
          <div class="space-y-2">
            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">📊 房地合一稅2.0</h3>
                  <p class="tax-description" id="unifiedTaxDesc">依持有年限計算</p>
                </div>
                <span class="tax-amount text-red-600" id="unifiedTax">NT$ 0</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏠 土地增值稅</h3>
                  <p class="tax-description">土地增值部分稅負</p>
                </div>
                <span class="tax-amount text-red-600" id="landTax">NT$ 30,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏢 仲介費 (賣方)</h3>
                  <p class="tax-description">賣方負擔仲介服務費 4%</p>
                </div>
                <span class="tax-amount text-red-600" id="sellerAgentFee">NT$ 60,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏠 房屋稅</h3>
                  <p class="tax-description">年度房屋稅 (按比例分攤)</p>
                </div>
                <span class="tax-amount text-red-600" id="houseTax">NT$ 8,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🏞️ 地價稅</h3>
                  <p class="tax-description">年度地價稅 (按比例分攤)</p>
                </div>
                <span class="tax-amount text-red-600" id="landValueTax">NT$ 5,000</span>
              </div>
            </div>

            <div class="tax-item">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="font-semibold text-sm">🔧 修繕費</h3>
                  <p class="tax-description">房屋修繕整理費用</p>
                </div>
                <span class="tax-amount text-red-600" id="repairFee">NT$ 10,000</span>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- 下方：資訊區域 -->
  <div class="grid-3 mt-6">
    <!-- 節稅建議 -->
    <section class="glass-card p-5 fade-in">
      <h3 class="section-title">
        <span class="text-2xl">💡</span>
        <span>節稅建議</span>
      </h3>
      <div class="space-y-2">
        <div class="flex items-start space-x-2 p-2 bg-green-50 rounded-lg">
          <span class="text-green-500 text-lg">💡</span>
          <span class="text-xs">持有超過5年可適用房地合一稅優惠稅率</span>
        </div>
        <div class="flex items-start space-x-2 p-2 bg-blue-50 rounded-lg">
          <span class="text-blue-500 text-lg">💡</span>
          <span class="text-xs">自用住宅重購退稅：2年內重購可申請退稅</span>
        </div>
        <div class="flex items-start space-x-2 p-2 bg-purple-50 rounded-lg">
          <span class="text-purple-500 text-lg">💡</span>
          <span class="text-xs">善用400萬自用住宅免稅額</span>
        </div>
        <div class="flex items-start space-x-2 p-2 bg-orange-50 rounded-lg">
          <span class="text-orange-500 text-lg">💡</span>
          <span class="text-xs">夫妻可善用每人每年220萬贈與免稅額</span>
        </div>
      </div>
    </section>

    <!-- 房地合一稅2.0說明 -->
    <section class="glass-card p-5 fade-in">
      <h3 class="section-title">
        <span class="text-2xl">📚</span>
        <span>房地合一稅2.0說明</span>
      </h3>
      <div class="space-y-2">
        <div class="p-3 bg-red-100 rounded-lg border-l-4 border-red-500">
          <h4 class="font-semibold text-red-800 text-sm">持有1年內</h4>
          <p class="text-red-700 text-base font-bold">稅率 45%</p>
        </div>
        <div class="p-3 bg-orange-100 rounded-lg border-l-4 border-orange-500">
          <h4 class="font-semibold text-orange-800 text-sm">持有1-2年</h4>
          <p class="text-orange-700 text-base font-bold">稅率 35%</p>
        </div>
        <div class="p-3 bg-yellow-100 rounded-lg border-l-4 border-yellow-500">
          <h4 class="font-semibold text-yellow-800 text-sm">持有2-5年</h4>
          <p class="text-yellow-700 text-base font-bold">稅率 20%</p>
        </div>
        <div class="p-3 bg-green-100 rounded-lg border-l-4 border-green-500">
          <h4 class="font-semibold text-green-800 text-sm">持有5-10年</h4>
          <p class="text-green-700 text-base font-bold">稅率 15%</p>
        </div>
        <div class="p-3 bg-blue-100 rounded-lg border-l-4 border-blue-500">
          <h4 class="font-semibold text-blue-800 text-sm">持有10年以上</h4>
          <p class="text-blue-700 text-base font-bold">稅率 15%</p>
        </div>
      </div>
    </section>

    <!-- 快速參考 -->
    <section class="glass-card p-5 fade-in">
      <h3 class="section-title">
        <span class="text-2xl">⚡</span>
        <span>快速參考</span>
      </h3>
      <div class="space-y-2">
        <div class="text-center p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg">
          <div class="text-xl font-bold text-blue-600">3%</div>
          <div class="text-xs text-gray-600">契稅費率</div>
        </div>
        <div class="text-center p-3 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg">
          <div class="text-xl font-bold text-green-600">400萬</div>
          <div class="text-xs text-gray-600">自用住宅免稅額</div>
        </div>
        <div class="text-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg">
          <div class="text-xl font-bold text-purple-600">2%</div>
          <div class="text-xs text-gray-600">仲介費率</div>
        </div>
      </div>
    </section>
  </div>
</main>

<script>
// 主題切換
document.getElementById('themeToggle').addEventListener('click', () => {
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  document.getElementById('themeToggle').textContent = isDark ? '🌙' : '🌞';
});

// 計算稅費
function calculateTaxes() {
  const housePrice = parseFloat(document.getElementById('housePrice').value) * 10000;
  const houseType = document.getElementById('houseType').value;
  const holdYears = parseInt(document.getElementById('holdYears').value);
  const houseUsage = document.getElementById('houseUsage').value;
  const costPrice = parseFloat(document.getElementById('costPrice').value) * 10000;
  const landArea = parseFloat(document.getElementById('landArea').value) || 25;
  const buildingArea = parseFloat(document.getElementById('buildingArea').value) || 35;
  const firstTimeBuyer = document.getElementById('firstTimeBuyer').value;

  if (!housePrice || !costPrice) return;

  // 買方稅費
  const deedTax = Math.round(housePrice * 0.03); // 契稅約3%
  const stampTax = Math.round(housePrice * 0.001); // 印花稅0.1%
  const registrationFee = Math.round(housePrice * 0.002); // 登記規費0.2%
  const bankFee = 8000; // 銀行費用固定
  const notaryFee = 15000; // 代書費固定
  const buyerAgentFee = Math.round(housePrice * 0.02); // 買方仲介費2%
  const guaranteeFee = 5000; // 履約保證費固定
  const insuranceFee = Math.round(buildingArea * 100); // 火險地震險按坪數計算

  // 房地合一稅2.0計算
  const profit = housePrice - costPrice; // 交易所得
  let unifiedTax = 0;
  let taxRate = 0;
  let taxDesc = '';

  if (profit > 0) {
    if (holdYears === 1) {
      taxRate = 0.45;
      taxDesc = '持有1年內稅率45%';
    } else if (holdYears === 2) {
      taxRate = 0.35;
      taxDesc = '持有1-2年稅率35%';
    } else if (holdYears === 5) {
      taxRate = 0.20;
      taxDesc = '持有2-5年稅率20%';
    } else if (holdYears === 10) {
      if (houseUsage === 'self') {
        // 自用住宅400萬免稅額
        const taxableProfit = Math.max(0, profit - 4000000);
        unifiedTax = Math.round(taxableProfit * 0.15);
        taxDesc = '持有5-10年稅率15% (自用住宅400萬免稅額)';
      } else {
        unifiedTax = Math.round(profit * 0.15);
        taxDesc = '持有5-10年稅率15%';
      }
    } else if (holdYears === 20) {
      if (houseUsage === 'self') {
        // 自用住宅400萬免稅額
        const taxableProfit = Math.max(0, profit - 4000000);
        unifiedTax = Math.round(taxableProfit * 0.15);
        taxDesc = '持有10年以上稅率15% (自用住宅400萬免稅額)';
      } else {
        unifiedTax = Math.round(profit * 0.15);
        taxDesc = '持有10年以上稅率15%';
      }
    }

    // 如果不是長期持有，直接計算
    if (holdYears < 10) {
      unifiedTax = Math.round(profit * taxRate);
    }
  }

  // 賣方稅費
  const landTax = Math.round(housePrice * 0.02); // 土地增值稅約2%
  const sellerAgentFee = Math.round(housePrice * 0.04); // 賣方仲介費4%
  const houseTax = Math.round(buildingArea * 200); // 房屋稅按坪數計算
  const landValueTax = Math.round(landArea * 150); // 地價稅按坪數計算
  const repairFee = 10000; // 修繕費固定

  // 更新顯示
  document.getElementById('deedTax').textContent = `NT$ ${deedTax.toLocaleString()}`;
  document.getElementById('stampTax').textContent = `NT$ ${stampTax.toLocaleString()}`;
  document.getElementById('registrationFee').textContent = `NT$ ${registrationFee.toLocaleString()}`;
  document.getElementById('bankFee').textContent = `NT$ ${bankFee.toLocaleString()}`;
  document.getElementById('notaryFee').textContent = `NT$ ${notaryFee.toLocaleString()}`;
  document.getElementById('buyerAgentFee').textContent = `NT$ ${buyerAgentFee.toLocaleString()}`;
  document.getElementById('guaranteeFee').textContent = `NT$ ${guaranteeFee.toLocaleString()}`;
  document.getElementById('insuranceFee').textContent = `NT$ ${insuranceFee.toLocaleString()}`;
  
  document.getElementById('unifiedTax').textContent = `NT$ ${unifiedTax.toLocaleString()}`;
  document.getElementById('unifiedTaxDesc').textContent = taxDesc || '依持有年限計算';
  document.getElementById('landTax').textContent = `NT$ ${landTax.toLocaleString()}`;
  document.getElementById('sellerAgentFee').textContent = `NT$ ${sellerAgentFee.toLocaleString()}`;
  document.getElementById('houseTax').textContent = `NT$ ${houseTax.toLocaleString()}`;
  document.getElementById('landValueTax').textContent = `NT$ ${landValueTax.toLocaleString()}`;
  document.getElementById('repairFee').textContent = `NT$ ${repairFee.toLocaleString()}`;

  // 計算總計
  const buyerTotal = deedTax + stampTax + registrationFee + bankFee + notaryFee + buyerAgentFee + guaranteeFee + insuranceFee;
  const sellerTotal = unifiedTax + landTax + sellerAgentFee + houseTax + landValueTax + repairFee;
  const totalTax = buyerTotal + sellerTotal;

  document.getElementById('buyerTotal').textContent = `NT$ ${buyerTotal.toLocaleString()}`;
  document.getElementById('sellerTotal').textContent = `NT$ ${sellerTotal.toLocaleString()}`;
  document.getElementById('totalTax').textContent = `NT$ ${totalTax.toLocaleString()}`;
}

// 監聽變化
document.querySelectorAll('input, select').forEach(element => {
  element.addEventListener('input', calculateTaxes);
});

// 初始計算
calculateTaxes();
</script>
</body>
</html>
