<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç¨…è²»è©¦ç®— - æ¿¬ç‘’æˆ¿ç”¢ç”Ÿæ´»å¹³å°</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root{
  --grad:linear-gradient(135deg,#3b82f6,#1d4ed8);
  --glass-bg:rgba(255,255,255,0.6);
  --glass-dark:rgba(30,30,30,0.6);
  --shadow-light:0 2px 8px rgba(0,0,0,.08);
  --border-radius:0.75rem;
  --transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

body{
  background:linear-gradient(to bottom,#dbeafe,#fff);
  transition:var(--transition);
  font-family:system-ui,-apple-system,sans-serif;
  line-height:1.5;
}

.glass-card{
  background:var(--glass-bg);
  backdrop-filter:blur(10px);
  border-radius:var(--border-radius);
  border:1px solid rgba(255,255,255,0.2);
}

.tax-item{
  background:rgba(255,255,255,0.8);
  border-radius:0.5rem;
  padding:0.75rem;
  margin-bottom:0.5rem;
  transition:var(--transition);
}

.result-card{
  background:var(--grad);
  color:white;
  border-radius:var(--border-radius);
  padding:1rem;
  text-align:center;
}

#themeToggle{
  position:fixed;
  top:0.75rem;
  right:0.75rem;
  background:var(--grad);
  color:#fff;
  border:none;
  padding:.4rem .6rem;
  border-radius:9999px;
  z-index:50;
  transition:var(--transition);
  cursor:pointer;
  font-size:1rem;
}
</style>
</head>
<body>
<!-- ä¸»é¡Œåˆ‡æ› -->
<button id="themeToggle" aria-label="åˆ‡æ›ä¸»é¡Œæ¨¡å¼">ğŸŒ</button>

<!-- è¿”å›æŒ‰éˆ• -->
<button onclick="history.back()" class="fixed top-3 left-3 bg-white shadow-lg rounded-full p-2.5 z-50 hover:scale-105 transition">
  â†
</button>

<!-- æ¨™é¡Œå€ -->
<header class="text-center py-4" style="background:var(--grad);color:white;">
  <h1 class="text-2xl font-bold">ğŸ“„ ç¨…è²»è©¦ç®—å·¥å…·</h1>
  <p class="text-xs opacity-90 mt-1">2025å¹´æˆ¿åœ°åˆä¸€ç¨…2.0æœ€æ–°ç¨…åˆ¶</p>
</header>

<main class="px-3 py-4 space-y-4">
  <!-- åŸºæœ¬è³‡è¨Š -->
  <section class="glass-card p-4 shadow-lg">
    <h2 class="text-lg font-bold mb-3">ğŸ“ æˆ¿å±‹è³‡è¨Š</h2>
    <div class="space-y-3">
      <div>
        <label class="block text-sm font-medium mb-1">æˆ¿å±‹ç¸½åƒ¹ (è¬å…ƒ)</label>
        <input type="number" id="housePrice" class="w-full p-2 border rounded-lg text-sm" placeholder="ä¾‹å¦‚ï¼š1500" value="1500">
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">æˆ¿å±‹é¡å‹</label>
        <select id="houseType" class="w-full p-2 border rounded-lg text-sm">
          <option value="new">æ–°å»ºæˆ¿å±‹</option>
          <option value="used" selected>ä¸­å¤å±‹</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">æŒæœ‰å¹´é™</label>
        <select id="holdYears" class="w-full p-2 border rounded-lg text-sm">
          <option value="1">1å¹´å…§</option>
          <option value="2">1-2å¹´</option>
          <option value="5">2-5å¹´</option>
          <option value="10" selected>5-10å¹´</option>
          <option value="20">10å¹´ä»¥ä¸Š</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">æˆ¿å±‹ç”¨é€”</label>
        <select id="houseUsage" class="w-full p-2 border rounded-lg text-sm">
          <option value="self" selected>è‡ªç”¨ä½å®…</option>
          <option value="investment">æŠ•è³‡ç”¨é€”</option>
          <option value="business">ç‡Ÿæ¥­ç”¨é€”</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">å–å¾—æˆæœ¬ (è¬å…ƒ)</label>
        <input type="number" id="costPrice" class="w-full p-2 border rounded-lg text-sm" placeholder="ä¾‹å¦‚ï¼š1200" value="1200">
      </div>
    </div>
  </section>

  <!-- è²·æ–¹ç¨…è²» -->
  <section class="glass-card p-4 shadow-lg">
    <h2 class="text-lg font-bold mb-3">ğŸ’° è²·æ–¹ç¨…è²»</h2>
    <div class="space-y-2">
      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ  å¥‘ç¨…</h3>
            <p class="text-xs text-gray-600">æˆ¿å±‹ç§»è½‰ç™»è¨˜ç¨…</p>
          </div>
          <span class="font-semibold text-blue-600 text-sm" id="deedTax">NT$ 45,000</span>
        </div>
      </div>

      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ“‹ å°èŠ±ç¨…</h3>
            <p class="text-xs text-gray-600">å¥‘ç´„æ›¸å°èŠ±ç¨…</p>
          </div>
          <span class="font-semibold text-blue-600 text-sm" id="stampTax">NT$ 1,500</span>
        </div>
      </div>

      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ“ ç™»è¨˜è¦è²»</h3>
            <p class="text-xs text-gray-600">åœ°æ”¿äº‹å‹™æ‰€è¦è²»</p>
          </div>
          <span class="font-semibold text-blue-600 text-sm" id="registrationFee">NT$ 3,000</span>
        </div>
      </div>

      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ¦ éŠ€è¡Œè²»ç”¨</h3>
            <p class="text-xs text-gray-600">è²¸æ¬¾è¨­å®šè²»ã€æ‰‹çºŒè²»</p>
          </div>
          <span class="font-semibold text-blue-600 text-sm" id="bankFee">NT$ 8,000</span>
        </div>
      </div>

      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ¢ ä»£æ›¸è²»</h3>
            <p class="text-xs text-gray-600">ä»£æ›¸æœå‹™è²»ç”¨</p>
          </div>
          <span class="font-semibold text-blue-600 text-sm" id="notaryFee">NT$ 15,000</span>
        </div>
      </div>
    </div>
  </section>

  <!-- è³£æ–¹ç¨…è²» -->
  <section class="glass-card p-4 shadow-lg">
    <h2 class="text-lg font-bold mb-3">ğŸ’¸ è³£æ–¹ç¨…è²»</h2>
    <div class="space-y-2">
      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ“Š æˆ¿åœ°åˆä¸€ç¨…2.0</h3>
            <p class="text-xs text-gray-600" id="unifiedTaxDesc">ä¾æŒæœ‰å¹´é™è¨ˆç®—</p>
          </div>
          <span class="font-semibold text-red-600 text-sm" id="unifiedTax">NT$ 0</span>
        </div>
      </div>

      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ  åœŸåœ°å¢å€¼ç¨…</h3>
            <p class="text-xs text-gray-600">åœŸåœ°å¢å€¼éƒ¨åˆ†ç¨…è² </p>
          </div>
          <span class="font-semibold text-red-600 text-sm" id="landTax">NT$ 30,000</span>
        </div>
      </div>

      <div class="tax-item">
        <div class="flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-sm">ğŸ¢ ä»²ä»‹è²»</h3>
            <p class="text-xs text-gray-600">æˆ¿å±‹ä»²ä»‹æœå‹™è²»</p>
          </div>
          <span class="font-semibold text-red-600 text-sm" id="agentFee">NT$ 30,000</span>
        </div>
      </div>
    </div>
  </section>

  <!-- ç¨…è²»ç¸½è¨ˆ -->
  <section class="result-card">
    <h3 class="text-lg font-bold mb-3">ğŸ’° ç¨…è²»ç¸½è¨ˆ</h3>
    <div class="grid grid-cols-2 gap-3 text-center">
      <div>
        <div class="text-xl font-bold" id="buyerTotal">NT$ 72,500</div>
        <div class="text-xs opacity-80">è²·æ–¹è² æ“”</div>
      </div>
      <div>
        <div class="text-xl font-bold" id="sellerTotal">NT$ 60,000</div>
        <div class="text-xs opacity-80">è³£æ–¹è² æ“”</div>
      </div>
    </div>
    <div class="mt-3 pt-3 border-t border-white/20">
      <div class="text-2xl font-bold" id="totalTax">NT$ 132,500</div>
      <div class="text-xs opacity-80">ç¸½ç¨…è²»</div>
    </div>
  </section>

  <!-- ç¯€ç¨…å»ºè­° -->
  <section class="glass-card p-4 shadow-lg">
    <h3 class="text-lg font-bold mb-3">ğŸ’¡ ç¯€ç¨…å»ºè­°</h3>
    <div class="space-y-2 text-xs">
      <div class="flex items-start space-x-2">
        <span class="text-green-500">ğŸ’¡</span>
        <span>æŒæœ‰è¶…é5å¹´å¯é©ç”¨æˆ¿åœ°åˆä¸€ç¨…å„ªæƒ ç¨…ç‡</span>
      </div>
      <div class="flex items-start space-x-2">
        <span class="text-green-500">ğŸ’¡</span>
        <span>è‡ªç”¨ä½å®…é‡è³¼é€€ç¨…ï¼š2å¹´å…§é‡è³¼å¯ç”³è«‹é€€ç¨…</span>
      </div>
      <div class="flex items-start space-x-2">
        <span class="text-green-500">ğŸ’¡</span>
        <span>å–„ç”¨400è¬è‡ªç”¨ä½å®…å…ç¨…é¡</span>
      </div>
      <div class="flex items-start space-x-2">
        <span class="text-green-500">ğŸ’¡</span>
        <span>å¤«å¦»å¯å–„ç”¨æ¯äººæ¯å¹´220è¬è´ˆèˆ‡å…ç¨…é¡</span>
      </div>
    </div>
  </section>

  <!-- æˆ¿åœ°åˆä¸€ç¨…2.0èªªæ˜ -->
  <section class="glass-card p-4 shadow-lg">
    <h3 class="text-lg font-bold mb-3">ğŸ“š æˆ¿åœ°åˆä¸€ç¨…2.0èªªæ˜</h3>
    <div class="space-y-2 text-xs">
      <div class="p-2 bg-red-50 rounded-lg">
        <h4 class="font-semibold text-red-800">æŒæœ‰1å¹´å…§</h4>
        <p class="text-red-700">ç¨…ç‡45%</p>
      </div>
      <div class="p-2 bg-orange-50 rounded-lg">
        <h4 class="font-semibold text-orange-800">æŒæœ‰1-2å¹´</h4>
        <p class="text-orange-700">ç¨…ç‡35%</p>
      </div>
      <div class="p-2 bg-yellow-50 rounded-lg">
        <h4 class="font-semibold text-yellow-800">æŒæœ‰2-5å¹´</h4>
        <p class="text-yellow-700">ç¨…ç‡20%</p>
      </div>
      <div class="p-2 bg-green-50 rounded-lg">
        <h4 class="font-semibold text-green-800">æŒæœ‰5-10å¹´</h4>
        <p class="text-green-700">ç¨…ç‡15%</p>
      </div>
      <div class="p-2 bg-blue-50 rounded-lg">
        <h4 class="font-semibold text-blue-800">æŒæœ‰10å¹´ä»¥ä¸Š</h4>
        <p class="text-blue-700">ç¨…ç‡15%</p>
      </div>
    </div>
  </section>
</main>

<script>
// ä¸»é¡Œåˆ‡æ›
document.getElementById('themeToggle').addEventListener('click', () => {
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  document.getElementById('themeToggle').textContent = isDark ? 'ğŸŒ™' : 'ğŸŒ';
});

// è¨ˆç®—ç¨…è²»
function calculateTaxes() {
  const housePrice = parseFloat(document.getElementById('housePrice').value) * 10000;
  const houseType = document.getElementById('houseType').value;
  const holdYears = parseInt(document.getElementById('holdYears').value);
  const houseUsage = document.getElementById('houseUsage').value;
  const costPrice = parseFloat(document.getElementById('costPrice').value) * 10000;

  if (!housePrice || !costPrice) return;

  // è²·æ–¹ç¨…è²»
  const deedTax = Math.round(housePrice * 0.03); // å¥‘ç¨…ç´„3%
  const stampTax = Math.round(housePrice * 0.001); // å°èŠ±ç¨…0.1%
  const registrationFee = Math.round(housePrice * 0.002); // ç™»è¨˜è¦è²»0.2%
  const bankFee = 8000; // éŠ€è¡Œè²»ç”¨å›ºå®š
  const notaryFee = 15000; // ä»£æ›¸è²»å›ºå®š

  // æˆ¿åœ°åˆä¸€ç¨…2.0è¨ˆç®—
  const profit = housePrice - costPrice; // äº¤æ˜“æ‰€å¾—
  let unifiedTax = 0;
  let taxRate = 0;
  let taxDesc = '';

  if (profit > 0) {
    if (holdYears === 1) {
      taxRate = 0.45;
      taxDesc = 'æŒæœ‰1å¹´å…§ç¨…ç‡45%';
    } else if (holdYears === 2) {
      taxRate = 0.35;
      taxDesc = 'æŒæœ‰1-2å¹´ç¨…ç‡35%';
    } else if (holdYears === 5) {
      taxRate = 0.20;
      taxDesc = 'æŒæœ‰2-5å¹´ç¨…ç‡20%';
    } else if (holdYears === 10) {
      if (houseUsage === 'self') {
        // è‡ªç”¨ä½å®…400è¬å…ç¨…é¡
        const taxableProfit = Math.max(0, profit - 4000000);
        unifiedTax = Math.round(taxableProfit * 0.15);
        taxDesc = 'æŒæœ‰5-10å¹´ç¨…ç‡15% (è‡ªç”¨ä½å®…400è¬å…ç¨…é¡)';
      } else {
        unifiedTax = Math.round(profit * 0.15);
        taxDesc = 'æŒæœ‰5-10å¹´ç¨…ç‡15%';
      }
    } else if (holdYears === 20) {
      if (houseUsage === 'self') {
        // è‡ªç”¨ä½å®…400è¬å…ç¨…é¡
        const taxableProfit = Math.max(0, profit - 4000000);
        unifiedTax = Math.round(taxableProfit * 0.15);
        taxDesc = 'æŒæœ‰10å¹´ä»¥ä¸Šç¨…ç‡15% (è‡ªç”¨ä½å®…400è¬å…ç¨…é¡)';
      } else {
        unifiedTax = Math.round(profit * 0.15);
        taxDesc = 'æŒæœ‰10å¹´ä»¥ä¸Šç¨…ç‡15%';
      }
    }

    // å¦‚æœä¸æ˜¯é•·æœŸæŒæœ‰ï¼Œç›´æ¥è¨ˆç®—
    if (holdYears < 10) {
      unifiedTax = Math.round(profit * taxRate);
    }
  }

  const landTax = Math.round(housePrice * 0.02); // åœŸåœ°å¢å€¼ç¨…ç´„2%
  const agentFee = Math.round(housePrice * 0.02); // ä»²ä»‹è²»2%

  // æ›´æ–°é¡¯ç¤º
  document.getElementById('deedTax').textContent = `NT$ ${deedTax.toLocaleString()}`;
  document.getElementById('stampTax').textContent = `NT$ ${stampTax.toLocaleString()}`;
  document.getElementById('registrationFee').textContent = `NT$ ${registrationFee.toLocaleString()}`;
  document.getElementById('bankFee').textContent = `NT$ ${bankFee.toLocaleString()}`;
  document.getElementById('notaryFee').textContent = `NT$ ${notaryFee.toLocaleString()}`;
  document.getElementById('unifiedTax').textContent = `NT$ ${unifiedTax.toLocaleString()}`;
  document.getElementById('unifiedTaxDesc').textContent = taxDesc || 'ä¾æŒæœ‰å¹´é™è¨ˆç®—';
  document.getElementById('landTax').textContent = `NT$ ${landTax.toLocaleString()}`;
  document.getElementById('agentFee').textContent = `NT$ ${agentFee.toLocaleString()}`;

  // è¨ˆç®—ç¸½è¨ˆ
  const buyerTotal = deedTax + stampTax + registrationFee + bankFee + notaryFee;
  const sellerTotal = unifiedTax + landTax + agentFee;
  const totalTax = buyerTotal + sellerTotal;

  document.getElementById('buyerTotal').textContent = `NT$ ${buyerTotal.toLocaleString()}`;
  document.getElementById('sellerTotal').textContent = `NT$ ${sellerTotal.toLocaleString()}`;
  document.getElementById('totalTax').textContent = `NT$ ${totalTax.toLocaleString()}`;
}

// ç›£è½è®ŠåŒ–
document.querySelectorAll('input, select').forEach(element => {
  element.addEventListener('input', calculateTaxes);
});

// åˆå§‹è¨ˆç®—
calculateTaxes();
</script>
</body>
</html>
